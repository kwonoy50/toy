<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board.BoardRepository">


<select id="selectList" resultType="java.util.HashMap">
<![CDATA[
SELECT        
        BOARD_NO
       ,BOARD_TITLE
       ,BOARD_CONTENT
       ,BOARD_USER_ID
       ,BOARD_REGDATE
  FROM
        BOARD
 WHERE  1 = 1
]]>
</select>


<select id="selectDetail" parameterType="com.toy.board.vo.BoardVo" resultType="com.toy.board.vo.BoardVo">
<![CDATA[
SELECT
        BOARD_NO
       ,BOARD_TITLE
       ,BOARD_CONTENT
       ,BOARD_USER_ID
       ,BOARD_REGDATE
  FROM
        BOARD
 WHERE  1 = 1
   AND  BOARD_NO = #{boardNo}
]]>
</select>


<insert id="insertBoard" parameterType="java.util.HashMap">
<![CDATA[
INSERT INTO BOARD
     (
	   BOARD_NO
     , BOARD_TITLE
     , BOARD_CONTENT
     , BOARD_USER_ID
     , BOARD_REGDATE
     ) 
VALUES 
     (
       (SELECT NVL(MAX(BOARD_NO), 0)+1 FROM BOARD)
     , #{BOARD_TITLE}
     , #{BOARD_CONTENT}
     , #{BOARD_USER_ID}
     , SYSDATE
     )
]]>
</insert>


<delete id="deleteBoard" parameterType="java.util.HashMap">
<![CDATA[
DELETE FROM BOARD
 WHERE 1 = 1
   AND BOARD_NO = #{BOARD_NO}
]]>
</delete>


<update id="updateBoard" parameterType="java.util.HashMap">
<![CDATA[
UPDATE BOARD SET
       BOARD_TITLE    = #{BOARD_TITLE}
     , BOARD_CONTENT  = #{BOARD_CONTENT}
     , BOARD_USER_ID  = #{BOARD_USER_ID}
     , BOARD_REGDATE  = SYSDATE
 WHERE 1 = 1
   AND BOARD_NO = #{BOARD_NO}
]]>
</update>


<select id="selectSearch" parameterType="java.util.HashMap" resultType="java.util.HashMap">
<![CDATA[
SELECT        
        BOARD_NO
       ,BOARD_TITLE
       ,BOARD_CONTENT
       ,BOARD_USER_ID
       ,BOARD_REGDATE
  FROM
        BOARD
 WHERE  1 = 1
]]>
<if test='keyword != null'>
    <if test='search.equals("title")'>
    <![CDATA[
    AND BOARD_TITLE LIKE CONCAT('%', #{keyword}, '%')  
    ]]>
    </if>
    <if test='search.equals("userId")'>
    <![CDATA[
    AND BOARD_USER_ID LIKE CONCAT('%', #{keyword}, '%')  
    ]]>
    </if>
    <if test='search.equals("content")'>
    <![CDATA[
    AND BOARD_CONTENT LIKE CONCAT('%', #{keyword}, '%')  
    ]]>
    </if>
</if>
</select>


</mapper>
